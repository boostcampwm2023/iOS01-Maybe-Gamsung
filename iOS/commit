#!/bin/sh

LINTPATH='.swiftlint.yml'
declare -a PATHS=("MSCoreKit" "MSFoundation" "MSUIKit" "MusicSpot")
failures=""

for path in "${PATHS[@]}"; do
    if [ -d "$path" ]; then
        echo "üëÄ Running SwiftLint for $path"
        result=$(swiftlint lint --progress --config $LINTPATH $path)
        if [ "$result" == '' ]; then
            echo "‚úÖ Lint succeed for $path\n"
        else
            echo "‚ùå Lint failed for $path\n"
            failures+="\n\033[1m‚úîÔ∏è $path\033[0m\n$result\n"
        fi
    else
        echo "‚ùì $path directory does not exist."
        exit 1
    fi
done

if [ ! -z "$failures" ]; then
    echo "$failures"
    exit 1
else
    echo "‚ú® All linting checks passed. Ready to commit."
    gitmoji -c
fi
