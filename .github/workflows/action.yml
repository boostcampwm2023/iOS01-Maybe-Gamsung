# name: musicspot github actions

# on:
#     pull_request:
#         branches: ["BE/release"]
#         types: ["closed"]
# jobs:
#     deploy:
#         runs-on: ubuntu-latest

#         steps:
#             - name: Checkout repository
#               uses: actions/checkout@v2

#             - name: Set up Node.js
#               uses: actions/setup-node@v2
#               with:
#                   node-version: "20"

#             - name: Install dependencies
#               run: |
#                   cd BE
#                   cd musicspot
#                   npm install

#             - name: Build Docker image
#               run: docker build -t musicspot:latest ./BE/musicspot

#             - name: Login to Docker Hub
#               run: docker login -u ${{ secrets.DOCKER_USERNAME }} -p ${{ secrets.DOCKER_PASSWORD }}

#             - name: Push Docker image to Docker Hub
#               run: docker push musicspot

#             - name: SSH into Ubuntu server and pull the latest image
#               uses: appleboy/ssh-action@master
#               with:
#                   host: ${{ secrets.SERVER_IP }}
#                   username: ${{ secrets.SERVER_USERNAME }}
#                   password: ${{ secrets.PASSWORD }}
#                   script: |
#                       docker login -u ${{ secrets.DOCKER_USERNAME }} -p ${{ secrets.DOCKER_PASSWORD }}
#                       docker pull musicspot
#                       docker stop musicspot || true
#                       docker rm musicspot || true
#                       docker run -e SSH_HOST=${{ secrets.SSH_HOST }} -e SSH_PORT=${{ secrets.SSH_PORT }} -e SSH_USER=${{ secrets.SSH_USER }} -e SSH_PASSWORD=${{ secrets.SSH_PASSWORD }} -e DB_USERNAME=${{ secrets.DB_USERNAME }} -e DB_PASSWORD=${{ secrets.DB_PASSWORD }} -e DB_NAME=${{ secrets.DB_NAME }} -e DB_HOST=${{ secrets.DB_HOST }} -e SECRET_KEY=${{ secrets.SECRET_KEY }} -v /images:/images -v /images/profile:/images/profile -v /images/story:/images/story -d -p 3000:3000 --name heatpick-container geomgichoi/heatpick
